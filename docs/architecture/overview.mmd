%%{init: {"flowchart": {"curve": "linear", "nodeSpacing": 70, "rankSpacing": 80}, "themeVariables": {"fontSize": "22px", "fontFamily": "Segoe UI, Verdana, Arial, sans-serif"}} }%%
flowchart LR
  %% Simple architecture overview (REST-exposable)

  subgraph Client
    User["User"]
    UI["ADK Web UI"]
  end

  subgraph Server
    Coord["Coordinator Agent"]
    SubA["Sub Agents (per control)"]

    Ingest["Ingest uploads"]
    Analyze["Analyze by ids"]
    GetInstr["Get system instructions"]

    Cache[("Evidence Cache")]
  end

  subgraph Infra
    Mongo[("MongoDB")] 
    Model["Model via TachyonAdkClient"]
    REST["Any REST endpoint"]
  end

  User --> UI --> Coord -->|delegates| SubA

  %% Tool calls from sub-agents
  SubA -->|call| GetInstr
  GetInstr --> Mongo

  SubA -->|call| Ingest
  Ingest --> Cache

  SubA -->|call| Analyze
  Analyze --> Cache
  Analyze --> Mongo

  %% LLM usage
  Coord --> Model
  SubA --> Model

  %% Output exposure
  Coord -->|combined report| REST

  %% Bold styling
  classDef bold font-weight:bold;
  class User,UI,Coord,SubA,Ingest,Analyze,GetInstr,Cache,Mongo,Model,REST bold
